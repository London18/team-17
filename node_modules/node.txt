var express = require('express');
var mysql = require('mysql')
var app = express();

app.set("view engine","ejs")

var connection = mysql.createConnection({
    host : 'localhost',
    user: 'lucbellintani',
    database: 'joinus'
});
 
app.get("/", function(req, res){
  var q = "SELECT COUNT(*) AS count FROM users";
  connection.query(q,function(err, result) {
   if (err) throw err;
   var count = result[0].count;
  // res.send("We have " +count+" users!");
   res.render("home", {data :count});
 });
});
 
 app.get("/joke", function(req, res){
 res.send("My life");
});
 
 app.get("/random_num", function(req, res){
 var num = Math.floor((Math.random() * 10) + 1);
 res.send("Your lucky number is " + num);
});
 
app.listen(8080, function () {
 console.log('App listening on port 8080!');
});

